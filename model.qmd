title: "MVP Model"
execute:
  python: true
  

#now we use machine to rank who has the best chance of winning mvp for the upcoming season and rank the top 10.

target_year = df["Year"].max() #finds the maximum year of the years we have, since mvp data is most helpful when recent

url = f"https://www.basketball-reference.com/leagues/NBA_2026_per_game.html"
data_players = requests.get(url)
soup = bs(data_players.text, "html.parser")

player_df  = pd.read_html(str(soup), header = 0)[0]

#print (player_df.columns)
#print (player_df.head(15))

stat_cols = ["PTS", "AST", "TRB", "FG%", "BLK", "STL"]

player_df = player_df[player_df["Player"].notna()].copy()
player_df = player_df[player_df["Player"] != "Player"].copy()

player_df = player_df[~player_df["Team"].astype(str).str.contains("TM")].copy()

print (player_df.columns)
print (player_df.head(15))

for col in stat_cols:
    if col in player_df.columns:
        player_df[col] = pd.to_numeric(player_df[col], errors = "coerce")

print (player_df[stat_cols].dtypes)

player_df = (
    player_df.sort_values("G", ascending=False).groupby("Player", as_index=False).head(1) #this code fixes it
)

print (player_df[player_df["Player"].str.contains("Luka", na=False)]) #this fixes the luka problem where luka is printed 2x